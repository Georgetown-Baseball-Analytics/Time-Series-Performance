filter(!is.na(bip_result) | !is.na(non_bip_result)) %>%
group_by(pitch_group, outing_id, pa_id) %>%
summarize(
pa_outcome = if_else(!is.na(bip_result), bip_result, non_bip_result)
) %>%
mutate(
single_bin = case_when(
pa_outcome %in% c("Single") ~ 1,
TRUE ~ 0),
double_bin = case_when(
pa_outcome %in% c("Double", "Ground Rule Double") ~ 1,
TRUE ~ 0),
triple_bin = case_when(
pa_outcome %in% c("Triple") ~ 1,
TRUE ~ 0),
hr_bin = case_when(
pa_outcome %in% c("Home Run") ~ 1,
TRUE ~ 0),
at_bat = case_when(
pa_outcome %in% c("Walk", "Sacrifice Bunt", "Sacrifice Fly", "Hit By Pitch") ~ 0,
TRUE ~ 1)
)
d_slg_collapsed <- d_slg %>%
group_by(pitch_group) %>%
summarize(
Outcome = (sum(single_bin) + 2*sum(double_bin) + 3*sum(triple_bin) + 4*sum(hr_bin))/sum(at_bat),
Name = ".SLG"
)
return(d_slg_collapsed)
}
ops_aggregation <- function(d) {
d_obp <- d %>%
group_by(outing_id, pa_id) %>%
summarize(no_result = sum(!is.na(bip_result)) + sum(!is.na(non_bip_result)))
#assertthat::assert_that(all(d_obp$no_result == 1))
# fix later
d_obp <- d %>%
filter(!is.na(bip_result) | !is.na(non_bip_result)) %>%
group_by(pitch_group, outing_id, pa_id) %>%
summarize(
pa_outcome = if_else(!is.na(bip_result), bip_result, non_bip_result)
) %>%
mutate( # this is what changes for slugging and OBP
obp_bin = case_when(
pa_outcome %in% c(
"Single",
"Double",
"Ground Rule Double",
"Triple",
"Hit By Pitch",
"Home Run",
"Walk"
) ~ 1,
pa_outcome %in% c(
"Sacrifice Bunt"
) ~ NA_real_,
TRUE ~ 0
# do this for all
)
)
d_obp_collapsed <- d_obp %>%
group_by(pitch_group) %>%
summarize(
obp = mean(obp_bin, na.rm = T),
)
d_slg <- d %>%
filter(!is.na(bip_result) | !is.na(non_bip_result)) %>%
group_by(pitch_group, outing_id, pa_id) %>%
summarize(
pa_outcome = if_else(!is.na(bip_result), bip_result, non_bip_result)
) %>%
mutate(
single_bin = case_when(
pa_outcome %in% c("Single") ~ 1,
TRUE ~ 0),
double_bin = case_when(
pa_outcome %in% c("Double", "Ground Rule Double") ~ 1,
TRUE ~ 0),
triple_bin = case_when(
pa_outcome %in% c("Triple") ~ 1,
TRUE ~ 0),
hr_bin = case_when(
pa_outcome %in% c("Home Run") ~ 1,
TRUE ~ 0),
at_bat = case_when(
pa_outcome %in% c("Walk", "Sacrifice Bunt", "Sacrifice Fly", "Hit By Pitch") ~ 0,
TRUE ~ 1)
)
d_slg_collapsed <- d_slg %>%
group_by(pitch_group) %>%
summarize(
slg = (sum(single_bin) + 2*sum(double_bin) + 3*sum(triple_bin) + 4*sum(hr_bin))/sum(at_bat),
)
d_ops_collapsed <- merge(d_slg_collapsed,d_obp_collapsed)
d_ops_collapsed <- d_ops_collapsed %>%
mutate(
Outcome = obp + slg,
Name = ".OPS"
) %>%
select(pitch_group, Outcome, Name)
return(d_ops_collapsed)
}
performance_pitchcount <- function(d) {
dpitchperf <- rbind(avg_aggregation(d), slg_aggregation(d), ops_aggregation(d))
graph5 <- ggplot(dpitchperf, aes(x = pitch_group, y = Outcome, group = Name, color = Name)) +
geom_point() +
geom_line() +
theme_bw()
return(graph5)
}
d <- group_pitch_counts(d)
strikepct_innings(d)
strikepct_pitchcount(d)
kandbbrate_pitchcount(d)
kandbbcount_pitchcount(d)
performance_pitchcount(d)
setwd("C:/Users/rajmo/Documents/Baseball/Time-Series-Performance/scripts")
#setwd("C:/Users/rajmo/Documents/Baseball/Time-Series-Performance/scripts")
source("import_synergy_data.R")
source("sabermetric_analysis.R")
d <- read.csv(d)
d <- group_pitch_counts(d)
strikepct_innings(d)
strikepct_pitchcount(d)
kandbbrate_pitchcount(d)
kandbbcount_pitchcount(d)
performance_pitchcount(d)
strikepct_innings(d)
strikepct_pitchcount(d)
kandbbrate_pitchcount(d)
kandbbcount_pitchcount(d)
strikepct_pitchcount(d)
setwd("C:/Users/rajmo/Documents/Baseball/Time-Series-Performance/scripts")
#setwd("C:/Users/rajmo/Documents/Baseball/Time-Series-Performance/scripts")
source("import_synergy_data.R")
source("sabermetric_analysis.R")
d <- read.csv(d)
d <- group_pitch_counts(d)
strikepct_innings(d)
strikepct_pitchcount(d)
kandbbrate_pitchcount(d)
performance_pitchcount(d)
strikepct_pitchcount(d)
outing_pitch_counts <- d %>%
group_by(outing_id) %>%
summarise(num_pitches = n())
View(outing_pitch_counts)
graph1 <- strikepct_innings(d)
graph2 <- strikepct_pitchcount(d)
graph3 <- kandbbrate_pitchcount(d)
graph4 <- performance_pitchcount(d)
plot_list <- list(graph1, graph2, graph3, graph4)
file <- tempfile()
saveRDS(plot_list, file)
rmarkdown::render('rmarkdownfile.Rmd', params = list(file = file))
plot_list <- list(graph1, graph2, graph3, graph4)
file <- tempfile()
saveRDS(plot_list, file)
rmarkdown::render('rmarkdownfile.Rmd', params = list(file = file))
plot_list <- list(graph1, graph2, graph3, graph4)
file <- tempfile()
saveRDS(plot_list, file)
rmarkdown::render('rmarkdownfile.Rmd', params = list(file = file))
plot_list <- list(graph1, graph2, graph3, graph4)
file <- tempfile()
saveRDS(plot_list, file)
rmarkdown::render('rmarkdownfile.Rmd', params = list(file = file))
plot_list <- list(graph1, graph2, graph3, graph4)
file <- tempfile()
saveRDS(plot_list, file)
rmarkdown::render('rmarkdownfile.Rmd', params = list(file = file))
plot_list <- list(graph1, graph2, graph3, graph4)
file <- tempfile()
saveRDS(plot_list, file)
rmarkdown::render('rmarkdownfile.Rmd', params = list(file = file))
plot_list <- list(graph1, graph2, graph3, graph4)
file <- tempfile()
saveRDS(plot_list, file)
rmarkdown::render('rmarkdownfile.Rmd', params = list(file = file))
plot_list <- list(graph1, graph2, graph3, graph4)
file <- tempfile()
saveRDS(plot_list, file)
rmarkdown::render('rmarkdownfile.Rmd', params = list(file = file))
plot_list <- list(graph1, graph2, graph3, graph4)
file <- tempfile()
saveRDS(plot_list, file)
rmarkdown::render('rmarkdownfile.Rmd', params = list(file = file))
plot_list <- list(graph1, graph2, graph3, graph4)
file <- tempfile()
saveRDS(plot_list, file)
rmarkdown::render('rmarkdownfile.Rmd', params = list(file = file))
plot_list <- list(graph1, graph2, graph3, graph4)
file <- tempfile()
saveRDS(plot_list, file)
rmarkdown::render('rmarkdownfile.Rmd', params = list(file = file))
plot_list <- list(graph1, graph2, graph3, graph4)
file <- tempfile()
saveRDS(plot_list, file)
rmarkdown::render('rmarkdownfile.Rmd', params = list(file = file))
plot_list <- list(graph1, graph2, graph3, graph4)
file <- tempfile()
saveRDS(plot_list, file)
rmarkdown::render('rmarkdownfile.Rmd', params = list(file = file))
plot_list <- list(graph1, graph2, graph3, graph4)
file <- tempfile()
saveRDS(plot_list, file)
rmarkdown::render('rmarkdownfile.Rmd', params = list(file = file))
plot_list <- list(graph1, graph2, graph3, graph4)
file <- tempfile()
saveRDS(plot_list, file)
rmarkdown::render('rmarkdownfile.Rmd', params = list(file = file))
plot_list <- list(graph1, graph2, graph3, graph4)
file <- tempfile()
saveRDS(plot_list, file)
rmarkdown::render('rmarkdownfile.Rmd', params = list(file = file))
plot_list <- list(graph1, graph2, graph3, graph4)
file <- tempfile()
saveRDS(plot_list, file)
rmarkdown::render('rmarkdownfile.Rmd', params = list(file = file))
#setwd("C:/Users/rajmo/Documents/Baseball/Time-Series-Performance/scripts")
source("import_synergy_data.R")
d <- read.csv(d)
group_pitch_counts(d)
group_pitch_counts <- function(d) {
d <- replace(d,d == "", NA)
d <- d %>%
group_by(outing_id) %>%
mutate(
pitch_num_by_outing = row_number()) %>%
ungroup() %>%
mutate(
pitch_group_by_ten = (pitch_num_by_outing %/% 10) + 1,
pg_b = pitch_group_by_ten * 10,
pg_a = pg_b - 9,
pitch_group = str_c(pg_a, pg_b, sep = "-")
)
return(d)
}
group_pitch_counts(d)
View(d)
group_pitch_counts(d)
#setwd("C:/Users/rajmo/Documents/Baseball/Time-Series-Performance/scripts")
source("import_synergy_data.R")
source("sabermetric_analysis.R")
d <- read.csv(d)
d <- group_pitch_counts(d)
graph1 <- strikepct_innings(d)
graph2 <- strikepct_pitchcount(d)
graph3 <- kandbbrate_pitchcount(d)
graph4 <- performance_pitchcount(d)
plot_list <- list(graph1, graph2, graph3, graph4)
file <- tempfile()
saveRDS(plot_list, file)
rmarkdown::render('rmarkdownfile.Rmd', params = list(file = file))
#setwd("C:/Users/rajmo/Documents/Baseball/Time-Series-Performance/scripts")
source("import_synergy_data.R")
source("sabermetric_analysis.R")
d <- read.csv(d)
d <- group_pitch_counts(d)
graph1 <- strikepct_innings(d)
graph2 <- strikepct_pitchcount(d)
graph3 <- kandbbrate_pitchcount(d)
graph4 <- avg_and_obp_pitchcount(d)
graph5 <- slg_and_ops_pitchcount(d)
plot_list <- list(graph1, graph2, graph3, graph4, graph5)
file <- tempfile()
saveRDS(plot_list, file)
rmarkdown::render('rmarkdownfile.Rmd', params = list(file = file))
outing_pitch_counts <- d %>%
group_by(outing_id) %>%
summarise(num_pitches = n())
View(outing_pitch_counts)
nrow(outing_pitch_counts)
num_outings <- nrow(outing_pitch_counts)
#setwd("C:/Users/rajmo/Documents/Baseball/Time-Series-Performance/scripts")
source("import_synergy_data.R")
source("sabermetric_analysis.R")
d <- read.csv(d)
d <- group_pitch_counts(d)
graph1 <- strikepct_innings(d)
graph2 <- strikepct_pitchcount(d)
graph3 <- kandbbrate_pitchcount(d)
graph4 <- avg_and_obp_pitchcount(d)
graph5 <- slg_and_ops_pitchcount(d)
plot_list <- list(graph1, graph2, graph3, graph4, graph5)
file <- tempfile()
saveRDS(plot_list, file)
rmarkdown::render('rmarkdownfile.Rmd', params = list(file = file))
source("sabermetric_analysis.R")
strikepct_pitchcount(d)
source("sabermetric_analysis.R")
strikepct_pitchcount(d)
source("sabermetric_analysis.R")
kandbbrate_pitchcount(d)
source("sabermetric_analysis.R")
d <- read.csv(d)
d <- group_pitch_counts(d)
graph1 <- strikepct_innings(d)
graph2 <- strikepct_pitchcount(d)
graph3 <- kandbbrate_pitchcount(d)
graph4 <- avg_and_obp_pitchcount(d)
graph5 <- slg_and_ops_pitchcount(d)
plot_list <- list(graph1, graph2, graph3, graph4, graph5)
file <- tempfile()
saveRDS(plot_list, file)
rmarkdown::render('rmarkdownfile.Rmd', params = list(file = file))
outing_pitch_counts <- d %>%
group_by(outing_id) %>%
summarise(num_pitches = n())
View(outing_pitch_counts)
graph1 <- ggplot(outing_pitch_counts, aes(x = outing_id, y = num_pitches)) +
geom_point() +
geom_line()
graph1
graph1 <- ggplot(outing_pitch_counts, aes(x = outing_id, y = num_pitches)) +
geom_point() +
geom_line() +
labs(
title = paste(pitcher, "Pitches in Each Outing"),
y = "Number of Pitches Thrown",
x = "Outing Number",
) +
theme_bw()
pitcher <- unique(d$pitcher)
outing_pitch_counts <- d %>%
group_by(outing_id) %>%
summarise(num_pitches = n())
graph1 <- ggplot(outing_pitch_counts, aes(x = outing_id, y = num_pitches)) +
geom_point() +
geom_line() +
labs(
title = paste(pitcher, "Pitches in Each Outing"),
y = "Number of Pitches Thrown",
x = "Outing Number",
) +
theme_bw()
graph1
#setwd("C:/Users/rajmo/Documents/Baseball/Time-Series-Performance/scripts")
source("import_synergy_data.R")
source("sabermetric_analysis.R")
d <- read.csv(d)
d <- group_pitch_counts(d)
graph1 <- pitches_per_outing(d)
graph6 <- strikepct_innings(d)
graph5 <- strikepct_pitchcount(d)
graph2 <- kandbbrate_pitchcount(d)
graph3 <- avg_and_obp_pitchcount(d)
graph4 <- slg_and_ops_pitchcount(d)
plot_list <- list(graph1, graph2, graph3, graph4, graph5, graph6)
file <- tempfile()
saveRDS(plot_list, file)
rmarkdown::render('rmarkdownfile.Rmd', params = list(file = file))
setwd("C:/Users/rajmo/Documents/Baseball/Time-Series-Performance/scripts")
#setwd("C:/Users/rajmo/Documents/Baseball/Time-Series-Performance/scripts")
source("import_synergy_data.R")
source("sabermetric_analysis.R")
d <- read.csv(d)
d <- group_pitch_counts(d)
graph1 <- pitches_per_outing(d)
graph6 <- strikepct_innings(d)
graph5 <- strikepct_pitchcount(d)
graph2 <- kandbbrate_pitchcount(d)
graph3 <- avg_and_obp_pitchcount(d)
graph4 <- slg_and_ops_pitchcount(d)
plot_list <- list(graph1, graph2, graph3, graph4, graph5, graph6)
file <- tempfile()
saveRDS(plot_list, file)
rmarkdown::render('rmarkdownfile.Rmd', params = list(file = file))
plot_list <- list(graph1, graph2, graph3, graph4, graph5, graph6)
file <- tempfile()
saveRDS(plot_list, file)
rmarkdown::render('rmarkdownfile.Rmd', params = list(file = file))
plot_list <- list(graph1, graph2, graph3, graph4, graph5, graph6)
file <- tempfile()
saveRDS(plot_list, file)
rmarkdown::render('rmarkdownfile.Rmd', params = list(file = file))
setwd("C:/Users/rajmo/Documents/Baseball/Time-Series-Performance/scripts")
#setwd("C:/Users/rajmo/Documents/Baseball/Time-Series-Performance/scripts")
source("import_synergy_data.R")
source("sabermetric_analysis.R")
d <- read.csv(d)
d <- group_pitch_counts(d)
graph1 <- pitches_per_outing(d)
graph6 <- strikepct_innings(d)
graph5 <- strikepct_pitchcount(d)
graph2 <- kandbbrate_pitchcount(d)
graph3 <- avg_and_obp_pitchcount(d)
graph4 <- slg_and_ops_pitchcount(d)
plot_list <- list(graph1, graph2, graph3, graph4, graph5, graph6)
file <- tempfile()
saveRDS(plot_list, file)
rmarkdown::render('rmarkdownfile.Rmd', params = list(file = file))
d <- read.csv(d)
d <- group_pitch_counts(d)
graph1 <- pitches_per_outing(d)
d <- read.csv(d)
#setwd("C:/Users/rajmo/Documents/Baseball/Time-Series-Performance/scripts")
source("import_synergy_data.R")
source("sabermetric_analysis.R")
d <- read.csv(d)
d <- group_pitch_counts(d)
graph1 <- pitches_per_outing(d)
graph6 <- strikepct_innings(d)
graph5 <- strikepct_pitchcount(d)
graph2 <- kandbbrate_pitchcount(d)
graph3 <- avg_and_obp_pitchcount(d)
graph4 <- slg_and_ops_pitchcount(d)
plot_list <- list(graph1, graph2, graph3, graph4, graph5, graph6)
file <- tempfile()
saveRDS(plot_list, file)
rmarkdown::render('rmarkdownfile.Rmd', params = list(file = file))
#setwd("C:/Users/rajmo/Documents/Baseball/Time-Series-Performance/scripts")
source("import_synergy_data.R")
d <- read.csv(d)
d <- replace(d,d == "", NA)
View(d)
group_pitch_counts <- function(d) {
d <- replace(d,d == "", NA)
d <- d %>%
group_by(outing_id) %>%
mutate(
pitch_num_by_outing = row_number()) %>%
ungroup() %>%
mutate(
pitch_group_by_ten = (pitch_num_by_outing %/% 10) + 1,
pg_b = pitch_group_by_ten * 10,
pg_a = pg_b - 9,
pitch_group = str_c(pg_a, pg_b, sep = "-")
)
return(d)
}
#setwd("C:/Users/rajmo/Documents/Baseball/Time-Series-Performance/scripts")
source("import_synergy_data.R")
d <- read.csv(d)
View(d)
#setwd("C:/Users/rajmo/Documents/Baseball/Time-Series-Performance/scripts")
source("import_synergy_data.R")
#setwd("C:/Users/rajmo/Documents/Baseball/Time-Series-Performance/scripts")
source("import_synergy_data.R")
#setwd("C:/Users/rajmo/Documents/Baseball/Time-Series-Performance/scripts")
source("import_synergy_data.R")
#setwd("C:/Users/rajmo/Documents/Baseball/Time-Series-Performance/scripts")
source("import_synergy_data.R")
cur_inningnum <- d$inning_num[1]
cur_inningnum <- asnumeric(d$inning_num[1])
cur_inningnum <- as.numeric(d$inning_num[1])
#setwd("C:/Users/rajmo/Documents/Baseball/Time-Series-Performance/scripts")
source("import_synergy_data.R")
#setwd("C:/Users/rajmo/Documents/Baseball/Time-Series-Performance/scripts")
source("import_synergy_data.R")
#setwd("C:/Users/rajmo/Documents/Baseball/Time-Series-Performance/scripts")
source("import_synergy_data.R")
d <- d %>%
mutate(
top_or_bottom_letter = str_remove_all(inning, "[0-9]"),
top_of_frame = if_else(top_or_bottom_letter == "T", 1, 0),
inning_num = str_remove_all(inning, "[^0-9]")
)
d <- d %>%
mutate(
top_or_bottom_letter = str_remove_all(inning, "[0-9]"),
top_of_frame = if_else(top_or_bottom_letter == "T", 1, 0),
inning_num = str_remove_all(inning, "[^0-9]")
)
View(d)
d <- replace(d,d == "", NA)
View(d)
#setwd("C:/Users/rajmo/Documents/Baseball/Time-Series-Performance/scripts")
source("import_synergy_data.R")
source("sabermetric_analysis.R")
d <- read.csv(d)
d <- group_pitch_counts(d)
View(d)
graph1 <- pitches_per_outing(d)
graph6 <- strikepct_innings(d)
graph5 <- strikepct_pitchcount(d)
graph2 <- kandbbrate_pitchcount(d)
graph3 <- avg_and_obp_pitchcount(d)
graph4 <- slg_and_ops_pitchcount(d)
plot_list <- list(graph1, graph2, graph3, graph4, graph5, graph6)
file <- tempfile()
saveRDS(plot_list, file)
rmarkdown::render('rmarkdownfile.Rmd', params = list(file = file))
View(d)
d <- replace(d,d=="",NA)
View(d)
d[is.na(d)] = 0
d$inning_num[is.na(d$inning_num)] = 0
View(d)
#setwd("C:/Users/rajmo/Documents/Baseball/Time-Series-Performance/scripts")
source("import_synergy_data.R")
source("sabermetric_analysis.R")
d <- read.csv(d)
d <- group_pitch_counts(d)
View(d)
#setwd("C:/Users/rajmo/Documents/Baseball/Time-Series-Performance/scripts")
source("import_synergy_data.R")
#setwd("C:/Users/rajmo/Documents/Baseball/Time-Series-Performance/scripts")
source("import_synergy_data.R")
source("sabermetric_analysis.R")
d <- read.csv(d)
View(d)
#setwd("C:/Users/rajmo/Documents/Baseball/Time-Series-Performance/scripts")
source("import_synergy_data.R")
source("sabermetric_analysis.R")
d <- read.csv(d)
d <- group_pitch_counts(d)
View(d)
#setwd("C:/Users/rajmo/Documents/Baseball/Time-Series-Performance/scripts")
source("import_synergy_data.R")
source("import_synergy_data.R")
source("import_synergy_data.R")
