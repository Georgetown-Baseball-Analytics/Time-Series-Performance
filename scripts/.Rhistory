summarize(
Outcome = mean(bb_bin, na.rm = T),
Name = "BB rate",
Index = d$pg_b
)
View(d_bbrate_collapsed)
d_bbrate_collapsed <- d_kandbbrate %>%
group_by(pitch_group) %>%
summarize(
Outcome = mean(bb_bin, na.rm = T),
Name = "BB rate",
Index = d$pg_b
)
View(d_bbrate_collapsed)
d_bbrate_collapsed <- d_kandbbrate %>%
group_by(pitch_group) %>%
summarize(
Outcome = mean(bb_bin, na.rm = T),
Name = "BB rate"
)
View(d_bbrate_collapsed)
d_bbrate_collapsed <- d_kandbbrate %>%
group_by(pitch_group) %>%
summarize(
Outcome = mean(bb_bin, na.rm = T),
Name = "BB rate",
Index = 3
)
View(d_bbrate_collapsed)
d_bbrate_collapsed <- d_kandbbrate %>%
group_by(pitch_group) %>%
summarize(
Outcome = mean(bb_bin, na.rm = T),
Name = "BB rate",
Index = mean(pg_b)
)
d_bbrate_collapsed <- d_kandbbrate %>%
group_by(pitch_group) %>%
summarize(
Outcome = mean(bb_bin, na.rm = T),
Name = "BB rate",
Index = mean(d$pg_b)
)
View(d)
View(d_bbrate_collapsed)
d_kandbbrate <- d %>%
filter(!is.na(bip_result) | !is.na(non_bip_result)) %>%
group_by(pitch_group, outing_id, pa_id) %>%
summarize(
pa_outcome = if_else(!is.na(bip_result), bip_result, non_bip_result)
) %>%
mutate(
k_bin = case_when(
pa_outcome %in% c(
"Strikeout"
) ~ 1,
TRUE ~ 0
# do this for all
),
bb_bin = case_when(
pa_outcome %in% c(
"Walk"
) ~ 1,
TRUE ~ 0
# do this for all
)
)
View(d_kandbbrate)
d_kandbbrate <- d %>%
filter(!is.na(bip_result) | !is.na(non_bip_result)) %>%
group_by(pitch_group, outing_id, pa_id) %>%
summarize(
pa_outcome = if_else(!is.na(bip_result), bip_result, non_bip_result),
pg_b
) %>%
mutate(
k_bin = case_when(
pa_outcome %in% c(
"Strikeout"
) ~ 1,
TRUE ~ 0
# do this for all
),
bb_bin = case_when(
pa_outcome %in% c(
"Walk"
) ~ 1,
TRUE ~ 0
# do this for all
)
)
d_krate_collapsed <- d_kandbbrate %>%
group_by(pitch_group) %>%
summarize(
Outcome = mean(k_bin, na.rm = T),
Name = "K rate"
)
View(d_kandbbrate_graph)
View(d_kandbbrate)
d_krate_collapsed <- d_kandbbrate %>%
group_by(pitch_group) %>%
summarize(
Outcome = mean(k_bin, na.rm = T),
Name = "K rate",
pg_b
)
View(d_krate_collapsed)
d_krate_collapsed <- d_kandbbrate %>%
group_by(pitch_group) %>%
summarize(
Outcome = mean(k_bin, na.rm = T),
Name = "K rate",
)
View(d_kandbbrate)
d_krate_collapsed <- d_kandbbrate %>%
group_by(pitch_group) %>%
summarize(
Outcome = mean(k_bin, na.rm = T),
Name = "K rate",
Index = mean(pg_b)
)
View(d_krate_collapsed)
d_bbrate_collapsed <- d_kandbbrate %>%
group_by(pitch_group) %>%
summarize(
Outcome = mean(bb_bin, na.rm = T),
Name = "BB rate",
Index = mean(pg_b)
)
View(d_bbrate_collapsed)
d_krate_collapsed <- d_kandbbrate %>%
group_by(pitch_group) %>%
summarize(
Outcome = mean(k_bin, na.rm = T),
Name = "K rate",
Index = mean(pg_b)
)
d_bbrate_collapsed <- d_kandbbrate %>%
group_by(pitch_group) %>%
summarize(
Outcome = mean(bb_bin, na.rm = T),
Name = "BB rate",
Index = mean(pg_b)
)
d_kandbbrate_graph <- rbind(d_krate_collapsed,d_bbrate_collapsed)
View(d_bbrate_collapsed)
d_kandbbrate_graph <- d_kandbbrate_graph %>%
order(Index)
View(d_kandbbrate_graph)
order(d_kandbbrate_graph, Index)
d_kandbbrate_graph <- d_kandbbrate_graph %>%
order(d_kandbbrate_graph$Index)
d_kandbbrate_graph <- rbind(d_krate_collapsed,d_bbrate_collapsed)
View(d_kandbbrate_graph)
arrange(d_kandbbrate_graph, Index)
View(d_kandbbrate_graph)
d_kandbbrate_graph <- rbind(d_krate_collapsed,d_bbrate_collapsed)
d_kandbbrate_graph <- arrange(d_kandbbrate_graph, Index)
View(d_kandbbrate_graph)
ggplot(d_kandbbrate_graph, aes(x = pitch_group, y = Outcome, group = Name, color = Name)) +
geom_point() +
geom_line() +
geom_vline(aes(x = pitch_group, y = strike_pct), xintercept = upper_bound, linetype = "dotted", lwd = 1) +
scale_y_continuous(labels = scales::percent) +
labs(
title = paste(pitcher, "Strikeout and Walk Rate by Pitch Count"),
x = "Pitch Number",
caption = paste("In this data set,",pitcher, "averaged", rounded_avg_pitches_per_outing, "pitches per outing over", num_outings, "outings.")
) +
scale_color_manual(values = c("red", "dark green")) +
theme_bw() +
theme(
plot.caption = element_text(size = 9)
)
d_kandbbrate_graph <- rbind(d_krate_collapsed,d_bbrate_collapsed)
d_kandbbrate_graph <- arrange(d_kandbbrate_graph, Index)
pitcher <- unique(d$pitcher)
outing_pitch_counts <- d %>%
group_by(outing_id) %>%
summarise(num_pitches = n())
avg_pitches_per_outing <- mean(outing_pitch_counts$num_pitches)
rounded_avg_pitches_per_outing <- round(mean(outing_pitch_counts$num_pitches), digits = 0)
std_pitches_per_outing <- sd(outing_pitch_counts$num_pitches)
upper_bound <- (avg_pitches_per_outing/10+1) + (std_pitches_per_outing/10)
lower_bound <- (avg_pitches_per_outing/10+1) - (std_pitches_per_outing/10)
num_outings <- nrow(outing_pitch_counts)
graph3 <- ggplot(d_kandbbrate_graph, aes(x = pitch_group, y = Outcome, group = Name, color = Name)) +
geom_point() +
geom_line() +
geom_vline(aes(x = pitch_group, y = strike_pct), xintercept = upper_bound, linetype = "dotted", lwd = 1) +
scale_y_continuous(labels = scales::percent) +
labs(
title = paste(pitcher, "Strikeout and Walk Rate by Pitch Count"),
x = "Pitch Number",
caption = paste("In this data set,",pitcher, "averaged", rounded_avg_pitches_per_outing, "pitches per outing over", num_outings, "outings.")
) +
scale_color_manual(values = c("red", "dark green")) +
theme_bw() +
theme(
plot.caption = element_text(size = 9)
)
graph3
View(d_kandbbrate_graph)
ggplot(d_kandbbrate_graph, aes(x = pitch_group, y = Outcome, group = Name, color = Name)) +
geom_point() +
geom_line()
ggplot(d_kandbbrate_graph, aes(x = pitch_group, y = Outcome, group = Name, color = Name)) +
geom_point() +
geom_line() +
geom_vline(aes(x = pitch_group, y = strike_pct), xintercept = upper_bound, linetype = "dotted", lwd = 1) +
scale_y_continuous(labels = scales::percent) +
labs(
title = paste(pitcher, "Strikeout and Walk Rate by Pitch Count"),
x = "Pitch Number",
caption = paste("In this data set,",pitcher, "averaged", rounded_avg_pitches_per_outing, "pitches per outing over", num_outings, "outings.")
) +
scale_color_manual(values = c("red", "dark green")) +
theme_bw() +
theme(
plot.caption = element_text(size = 9)
)
ggplot(d_kandbbrate_graph, aes(x = pitch_group, y = Outcome, group = Name, color = Name)) +
geom_point() +
geom_line() +
geom_vline(aes(x = pitch_group, y = strike_pct), xintercept = upper_bound, linetype = "dotted", lwd = 1) +
scale_y_continuous(labels = scales::percent) +
scale_x_discrete() +
labs(
title = paste(pitcher, "Strikeout and Walk Rate by Pitch Count"),
x = "Pitch Number",
caption = paste("In this data set,",pitcher, "averaged", rounded_avg_pitches_per_outing, "pitches per outing over", num_outings, "outings.")
) +
scale_color_manual(values = c("red", "dark green")) +
theme_bw() +
theme(
plot.caption = element_text(size = 9)
)
ggplot(d_kandbbrate_graph, aes(x = pitch_group, y = Outcome, group = Name, color = Name)) +
geom_point() +
geom_line() +
geom_vline(aes(x = pitch_group, y = strike_pct), xintercept = upper_bound, linetype = "dotted", lwd = 1) +
scale_y_continuous(labels = scales::percent) +
scale_x_discrete() +
labs(
title = paste(pitcher, "Strikeout and Walk Rate by Pitch Count"),
x = "Pitch Number",
caption = paste("In this data set,",pitcher, "averaged", rounded_avg_pitches_per_outing, "pitches per outing over", num_outings, "outings.")
) +
scale_color_manual(values = c("red", "dark green")) +
theme_bw() +
theme(
plot.caption = element_text(size = 9)
)
d_kandbbrate_graph <- rbind(d_krate_collapsed,d_bbrate_collapsed)
pitcher <- unique(d$pitcher)
outing_pitch_counts <- d %>%
group_by(outing_id) %>%
summarise(num_pitches = n())
avg_pitches_per_outing <- mean(outing_pitch_counts$num_pitches)
rounded_avg_pitches_per_outing <- round(mean(outing_pitch_counts$num_pitches), digits = 0)
std_pitches_per_outing <- sd(outing_pitch_counts$num_pitches)
upper_bound <- (avg_pitches_per_outing/10+1) + (std_pitches_per_outing/10)
lower_bound <- (avg_pitches_per_outing/10+1) - (std_pitches_per_outing/10)
num_outings <- nrow(outing_pitch_counts)
graph3 <- ggplot(d_kandbbrate_graph, aes(x = pitch_group, y = Outcome, group = Name, color = Name)) +
geom_point() +
geom_line() +
geom_vline(aes(x = pitch_group, y = strike_pct), xintercept = upper_bound, linetype = "dotted", lwd = 1) +
scale_y_continuous(labels = scales::percent) +
labs(
title = paste(pitcher, "Strikeout and Walk Rate by Pitch Count"),
x = "Pitch Number",
caption = paste("In this data set,",pitcher, "averaged", rounded_avg_pitches_per_outing, "pitches per outing over", num_outings, "outings.")
) +
scale_color_manual(values = c("red", "dark green")) +
theme_bw() +
theme(
plot.caption = element_text(size = 9)
)
graph3
d_kandbbrate_graph <- rbind(d_krate_collapsed,d_bbrate_collapsed)
d_kandbbrate_graph <- arrange(d_kandbbrate_graph, Index)
pitcher <- unique(d$pitcher)
outing_pitch_counts <- d %>%
group_by(outing_id) %>%
summarise(num_pitches = n())
avg_pitches_per_outing <- mean(outing_pitch_counts$num_pitches)
rounded_avg_pitches_per_outing <- round(mean(outing_pitch_counts$num_pitches), digits = 0)
std_pitches_per_outing <- sd(outing_pitch_counts$num_pitches)
upper_bound <- (avg_pitches_per_outing/10+1) + (std_pitches_per_outing/10)
lower_bound <- (avg_pitches_per_outing/10+1) - (std_pitches_per_outing/10)
num_outings <- nrow(outing_pitch_counts)
graph3 <- ggplot(d_kandbbrate_graph, aes(x = pitch_group, y = Outcome, group = Name, color = Name)) +
geom_point() +
geom_line() +
geom_vline(aes(x = pitch_group, y = strike_pct), xintercept = upper_bound, linetype = "dotted", lwd = 1) +
scale_y_continuous(labels = scales::percent) +
labs(
title = paste(pitcher, "Strikeout and Walk Rate by Pitch Count"),
x = "Pitch Number",
caption = paste("In this data set,",pitcher, "averaged", rounded_avg_pitches_per_outing, "pitches per outing over", num_outings, "outings.")
) +
scale_color_manual(values = c("red", "dark green")) +
theme_bw() +
theme(
plot.caption = element_text(size = 9)
)
graph3
d_kandbbrate_graph <- rbind(d_krate_collapsed,d_bbrate_collapsed)
d_kandbbrate_graph <- arrange(d_kandbbrate_graph, Index)
View(d_krate_collapsed)
d_kandbbrate_graph <- arrange(d_kandbbrate_graph, Index)
View(d_kandbbrate_graph)
pitcher <- unique(d$pitcher)
outing_pitch_counts <- d %>%
group_by(outing_id) %>%
summarise(num_pitches = n())
avg_pitches_per_outing <- mean(outing_pitch_counts$num_pitches)
rounded_avg_pitches_per_outing <- round(mean(outing_pitch_counts$num_pitches), digits = 0)
std_pitches_per_outing <- sd(outing_pitch_counts$num_pitches)
upper_bound <- (avg_pitches_per_outing/10+1) + (std_pitches_per_outing/10)
lower_bound <- (avg_pitches_per_outing/10+1) - (std_pitches_per_outing/10)
num_outings <- nrow(outing_pitch_counts)
graph3 <- ggplot(d_kandbbrate_graph, aes(x = pitch_group, y = Outcome, group = Name, color = Name)) +
geom_point() +
geom_line() +
geom_vline(aes(x = pitch_group, y = strike_pct), xintercept = upper_bound, linetype = "dotted", lwd = 1) +
scale_y_continuous(labels = scales::percent) +
labs(
title = paste(pitcher, "Strikeout and Walk Rate by Pitch Count"),
x = "Pitch Number",
caption = paste("In this data set,",pitcher, "averaged", rounded_avg_pitches_per_outing, "pitches per outing over", num_outings, "outings.")
) +
scale_color_manual(values = c("red", "dark green")) +
theme_bw() +
theme(
plot.caption = element_text(size = 9)
)
graph3
ggplot(d_kandbbrate_graph, aes(x = Index, y = Outcome, group = Name, color = Name)) +
geom_point() +
geom_line() +
geom_vline(aes(x = pitch_group, y = strike_pct), xintercept = upper_bound, linetype = "dotted", lwd = 1) +
scale_y_continuous(labels = scales::percent) +
labs(
title = paste(pitcher, "Strikeout and Walk Rate by Pitch Count"),
x = "Pitch Number",
caption = paste("In this data set,",pitcher, "averaged", rounded_avg_pitches_per_outing, "pitches per outing over", num_outings, "outings.")
) +
scale_color_manual(values = c("red", "dark green")) +
theme_bw() +
theme(
plot.caption = element_text(size = 9)
)
ggplot(d_kandbbrate_graph, aes(x = Index, y = Outcome, group = Name, color = Name)) +
geom_point() +
geom_line() +
geom_vline(aes(x = pitch_group, y = strike_pct), xintercept = upper_bound, linetype = "dotted", lwd = 1) +
scale_y_continuous(labels = scales::percent) +
scale_x_discrete(labels = pitch_group) +
labs(
title = paste(pitcher, "Strikeout and Walk Rate by Pitch Count"),
x = "Pitch Number",
caption = paste("In this data set,",pitcher, "averaged", rounded_avg_pitches_per_outing, "pitches per outing over", num_outings, "outings.")
) +
scale_color_manual(values = c("red", "dark green")) +
theme_bw() +
theme(
plot.caption = element_text(size = 9)
)
ggplot(d_kandbbrate_graph, aes(x = Index, y = Outcome, group = Name, color = Name)) +
geom_point() +
geom_line() +
geom_vline(aes(x = pitch_group, y = strike_pct), xintercept = upper_bound, linetype = "dotted", lwd = 1) +
scale_y_continuous(labels = scales::percent) +
scale_x_discrete(labels = d$pitch_group) +
labs(
title = paste(pitcher, "Strikeout and Walk Rate by Pitch Count"),
x = "Pitch Number",
caption = paste("In this data set,",pitcher, "averaged", rounded_avg_pitches_per_outing, "pitches per outing over", num_outings, "outings.")
) +
scale_color_manual(values = c("red", "dark green")) +
theme_bw() +
theme(
plot.caption = element_text(size = 9)
)
ggplot(d_kandbbrate_graph, aes(x = Index, y = Outcome, group = Name, color = Name)) +
geom_point() +
geom_line() +
geom_vline(aes(x = pitch_group, y = strike_pct), xintercept = upper_bound, linetype = "dotted", lwd = 1) +
scale_y_continuous(labels = scales::percent) +
scale_x_discrete(limits = d$pitch_group) +
labs(
title = paste(pitcher, "Strikeout and Walk Rate by Pitch Count"),
x = "Pitch Number",
caption = paste("In this data set,",pitcher, "averaged", rounded_avg_pitches_per_outing, "pitches per outing over", num_outings, "outings.")
) +
scale_color_manual(values = c("red", "dark green")) +
theme_bw() +
theme(
plot.caption = element_text(size = 9)
)
ggplot(d_kandbbrate_graph, aes(x = Index, y = Outcome, group = Name, color = Name)) +
geom_point() +
geom_line() +
geom_vline(aes(x = pitch_group, y = strike_pct), xintercept = upper_bound, linetype = "dotted", lwd = 1) +
scale_y_continuous(labels = scales::percent) +
scale_x_discrete(limits = distinct(d$pitch_group)) +
labs(
title = paste(pitcher, "Strikeout and Walk Rate by Pitch Count"),
x = "Pitch Number",
caption = paste("In this data set,",pitcher, "averaged", rounded_avg_pitches_per_outing, "pitches per outing over", num_outings, "outings.")
) +
scale_color_manual(values = c("red", "dark green")) +
theme_bw() +
theme(
plot.caption = element_text(size = 9)
)
ggplot(d_kandbbrate_graph, aes(x = Index, y = Outcome, group = Name, color = Name)) +
geom_point() +
geom_line() +
geom_vline(aes(x = pitch_group, y = strike_pct), xintercept = upper_bound, linetype = "dotted", lwd = 1) +
scale_y_continuous(labels = scales::percent) +
scale_x_discrete(limits = unique(d$pitch_group)) +
labs(
title = paste(pitcher, "Strikeout and Walk Rate by Pitch Count"),
x = "Pitch Number",
caption = paste("In this data set,",pitcher, "averaged", rounded_avg_pitches_per_outing, "pitches per outing over", num_outings, "outings.")
) +
scale_color_manual(values = c("red", "dark green")) +
theme_bw() +
theme(
plot.caption = element_text(size = 9)
)
ggplot(d_kandbbrate_graph, aes(x = pitch_group, y = Outcome, group = Name, color = Name)) +
geom_point() +
geom_line() +
geom_vline(aes(x = pitch_group, y = strike_pct), xintercept = upper_bound, linetype = "dotted", lwd = 1) +
scale_y_continuous(labels = scales::percent) +
scale_x_discrete(limits = unique(d$pitch_group)) +
labs(
title = paste(pitcher, "Strikeout and Walk Rate by Pitch Count"),
x = "Pitch Number",
caption = paste("In this data set,",pitcher, "averaged", rounded_avg_pitches_per_outing, "pitches per outing over", num_outings, "outings.")
) +
scale_color_manual(values = c("red", "dark green")) +
theme_bw() +
theme(
plot.caption = element_text(size = 9)
)
d_kandbbrate <- d %>%
filter(!is.na(bip_result) | !is.na(non_bip_result)) %>%
group_by(pitch_group, outing_id, pa_id) %>%
summarize(
pa_outcome = if_else(!is.na(bip_result), bip_result, non_bip_result)
) %>%
mutate(
k_bin = case_when(
pa_outcome %in% c(
"Strikeout"
) ~ 1,
TRUE ~ 0
# do this for all
),
bb_bin = case_when(
pa_outcome %in% c(
"Walk"
) ~ 1,
TRUE ~ 0
# do this for all
)
)
d_krate_collapsed <- d_kandbbrate %>%
group_by(pitch_group) %>%
summarize(
Outcome = mean(k_bin, na.rm = T),
Name = "K rate"
)
d_bbrate_collapsed <- d_kandbbrate %>%
group_by(pitch_group) %>%
summarize(
Outcome = mean(bb_bin, na.rm = T),
Name = "BB rate"
)
d_kandbbrate_graph <- rbind(d_krate_collapsed,d_bbrate_collapsed)
pitcher <- unique(d$pitcher)
outing_pitch_counts <- d %>%
group_by(outing_id) %>%
summarise(num_pitches = n())
avg_pitches_per_outing <- mean(outing_pitch_counts$num_pitches)
rounded_avg_pitches_per_outing <- round(mean(outing_pitch_counts$num_pitches), digits = 0)
std_pitches_per_outing <- sd(outing_pitch_counts$num_pitches)
upper_bound <- (avg_pitches_per_outing/10+1) + (std_pitches_per_outing/10)
lower_bound <- (avg_pitches_per_outing/10+1) - (std_pitches_per_outing/10)
num_outings <- nrow(outing_pitch_counts)
graph3 <- ggplot(d_kandbbrate_graph, aes(x = pitch_group, y = Outcome, group = Name, color = Name)) +
geom_point() +
geom_line() +
geom_vline(aes(x = pitch_group, y = strike_pct), xintercept = upper_bound, linetype = "dotted", lwd = 1) +
scale_y_continuous(labels = scales::percent) +
scale_x_discrete(limits = unique(d$pitch_group)) +
labs(
title = paste(pitcher, "Strikeout and Walk Rate by Pitch Count"),
x = "Pitch Number",
caption = paste("In this data set,",pitcher, "averaged", rounded_avg_pitches_per_outing, "pitches per outing over", num_outings, "outings.")
) +
scale_color_manual(values = c("red", "dark green")) +
theme_bw() +
theme(
plot.caption = element_text(size = 9)
)
graph3
