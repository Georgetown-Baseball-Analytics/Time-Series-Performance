geom_point(mapping = aes(stroke = 2)) +
geom_smooth(mapping = aes(stroke = 5), se = FALSE)
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) +
geom_point(mapping = aes(stroke = 2)) +
geom_smooth(mapping = aes(weight = 5), se = FALSE)
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) +
geom_point(mapping = aes(stroke = 2)) +
geom_smooth(mapping = aes(size = 5), se = FALSE)
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) +
geom_point(mapping = aes(stroke = 2)) +
geom_smooth(mapping = aes(size = 4), se = FALSE)
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) +
geom_point(mapping = aes(stroke = 2)) +
geom_smooth(mapping = aes(size = 2), se = FALSE)
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) +
geom_point(mapping = aes(stroke = 2)) +
geom_smooth(mapping = aes(size = 1), se = FALSE)
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) +
geom_point(mapping = aes(stroke = 2)) +
geom_smooth(se = FALSE)
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) +
geom_point(mapping = aes(stroke = 2)) +
geom_smooth(mapping = aes(group = drv), se = FALSE)
ggplot(data = mpg, mapping = aes(x = displ, y = hwy, color = drv)) +
geom_point(mapping = aes(stroke = 2)) +
geom_smooth(mapping = aes(group = drv), se = FALSE)
ggplot(data = mpg, mapping = aes(x = displ, y = hwy, color = drv)) +
geom_point(mapping = aes(stroke = 2)) +
geom_smooth(se = FALSE)
geom_point(mapping = aes(stroke = 2, color = drv)) +
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) +
geom_point(mapping = aes(stroke = 2, color = drv)) +
geom_smooth(se = FALSE)
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) +
geom_point(mapping = aes(stroke = 2, color = drv)) +
geom_smooth(se = FALSE)
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) +
geom_point(mapping = aes(stroke = 2, color = drv)) +
geom_smooth(mapping = aes(line_type = drv), se = FALSE)
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) +
geom_point(mapping = aes(stroke = 2, color = drv)) +
geom_smooth(mapping = aes(linetype = drv), se = FALSE)
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) +
geom_point(mapping = aes(stroke = 2, color = drv))
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) +
geom_point(mapping = aes(stroke = "white", color = drv))
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) +
geom_point(mapping = aes(stroke = 2, color = drv))
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) +
geom_point(mapping = aes(stroke = 2, color = drv, fill = "white"))
geom_point(mapping = aes(stroke = 2, color = drv)
ggplot(mtcars, aes(wt, mpg)) +
geom_point(shape = 21, colour = "black", fill = "white", size = 5, stroke = 5)
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) +
geom_point(mapping = aes(stroke = 2, color = drv))
ggplot(mtcars, aes(wt, mpg)) +
geom_point(shape = 21, colour = "black", fill = "white", size = 5, stroke = 5)
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) +
geom_point(mapping = aes(stroke = 2, color = "white", fill = drv))
geom_point(mapping = aes(stroke = 2, color = drv)
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) +
geom_point(mapping = aes(stroke = 2, color = drv))
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) +
geom_point(mapping = aes(stroke = 2, color = drv))
ggplot(data = diamonds) +
geom_bar(mapping = aes(x = cut))
ggplot(data = diamonds) +
stat_count(mapping = aes(x = cut))
ggplot(data = diamonds) +
geom_bar(mapping = aes(x = cut, y = stat(prop), group = 1))
ggplot(data = diamonds) +
geom_bar(mapping = aes(x = cut, colour = cut))
ggplot(data = diamonds) +
geom_bar(mapping = aes(x = cut, fill = cut))
ggplot(data = diamonds) +
geom_bar(mapping = aes(x = cut, fill = clarity))
ggplot(data = diamonds, mapping = aes(x = cut, colour = clarity)) +
geom_bar(fill = NA, position = "identity")
ggplot(data = diamonds, mapping = aes(x = cut, fill = clarity)) +
geom_bar(alpha = 1/5, position = "identity")
ggplot(data = diamonds) +
geom_bar(mapping = aes(x = cut, fill = clarity), position = "fill")
ggplot(data = diamonds) +
geom_bar(mapping = aes(x = cut, fill = clarity), position = "dodge")
ggplot(data = mpg) +
geom_point(mapping = aes(x = displ, y = hwy), position = "jitter")
ggplot(data = mpg, mapping = aes(x = cty, y = hwy)) +
geom_point() +
geom_jitter()
ggplot(data = mpg, mapping = aes(x = cty, y = hwy)) +
geom_jitter()
ggplot(data = mpg, mapping = aes(x = cty, y = hwy)) +
geom_count()
ggplot(data = mpg) +
geom_boxplot(mapping = aes(x = displ, y = hwy))
ggplot(data = mpg, mapping = aes(x = class, y = hwy)) +
geom_boxplot() +
coord_flip()
#source("Kishor import.R")
library(tidyverse)
d <- read_csv("data_clean.csv")
d <- d %>%
mutate(
strike = case_when(
pitch_result %in% c("Strike Swinging", "Strike Taken", "Foul", "BIP") ~ 1,
TRUE ~ 0
)) %>%
group_by(outing_id) %>%
mutate(
pitch_num_by_outing = row_number()) %>%
ungroup() %>%
mutate(
pitch_group_by_ten = (pitch_num_by_outing %/% 10) + 1,
pg_b = pitch_group_by_ten * 10,
pg_a = pg_b - 9,
pitch_group = str_c(pg_a, pg_b, sep = "-")
)
dd <- d %>%
group_by(pitch_group) %>%
summarize(
strike_pct = mean(strike),
count = n(),
)
pitcher <- unique(d$pitcher)
ggplot(dd) +
geom_point(aes(x = pitch_group, y = strike_pct)) +
geom_line(aes(x = pitch_group, y = strike_pct, group = 1)) +
scale_y_continuous(labels = scales::percent) +
labs(title = paste(pitcher, "Strike % by Pitch Count"), y = "Strike Percentage", x = "Pitch Number") +
theme_bw()
d <- d %>%
mutate(
strikeout = case_when(
non_bip_result %in% c("Strikeout,") ~ 1,
TRUE ~ 0
)) %>%
mutate(
walk = case_when(
non_bip_result %in% c("Walk,") ~ 1,
TRUE ~ 0
))
dk <- d %>%
group_by(pitch_group) %>%
summarize(
Outcome = sum(strikeout),
Name = "Strikeout"
)
dbb <- d %>%
group_by(pitch_group) %>%
summarize(
Outcome = sum(walk),
Name = "Walk"
)
ddd <- rbind(dk, dbb)
ggplot(ddd, aes(x = pitch_group, y = Outcome, group = Name, color = Name)) +
geom_point() +
geom_line()
#source("Kishor import.R")
library(tidyverse)
d <- read_csv("data_clean.csv")
d <- read_csv("data_clean.csv")
#source("Kishor import.R")
library(tidyverse)
d <- read_csv("data_clean.csv")
source("Kishor import.R")
library(tidyverse)
d <- d %>%
mutate(
strike = case_when(
pitch_result %in% c("Strike Swinging", "Strike Taken", "Foul", "BIP") ~ 1,
TRUE ~ 0
)) %>%
group_by(outing_id) %>%
mutate(
pitch_num_by_outing = row_number()) %>%
ungroup() %>%
mutate(
pitch_group_by_ten = (pitch_num_by_outing %/% 10) + 1,
pg_b = pitch_group_by_ten * 10,
pg_a = pg_b - 9,
pitch_group = str_c(pg_a, pg_b, sep = "-")
)
d <- read_csv("Baseball\data_clean.csv")
d <- read_csv("Baseball/data_clean.csv")
d <- d %>%
mutate(
strike = case_when(
pitch_result %in% c("Strike Swinging", "Strike Taken", "Foul", "BIP") ~ 1,
TRUE ~ 0
)) %>%
group_by(outing_id) %>%
mutate(
pitch_num_by_outing = row_number()) %>%
ungroup() %>%
mutate(
pitch_group_by_ten = (pitch_num_by_outing %/% 10) + 1,
pg_b = pitch_group_by_ten * 10,
pg_a = pg_b - 9,
pitch_group = str_c(pg_a, pg_b, sep = "-")
)
dd <- d %>%
group_by(pitch_group) %>%
summarize(
strike_pct = mean(strike),
count = n(),
)
pitcher <- unique(d$pitcher)
ggplot(dd) +
geom_point(aes(x = pitch_group, y = strike_pct)) +
geom_line(aes(x = pitch_group, y = strike_pct, group = 1)) +
scale_y_continuous(labels = scales::percent) +
labs(title = paste(pitcher, "Strike % by Pitch Count"), y = "Strike Percentage", x = "Pitch Number") +
theme_bw()
d <- d %>%
mutate(
strikeout = case_when(
non_bip_result %in% c("Strikeout,") ~ 1,
TRUE ~ 0
)) %>%
mutate(
walk = case_when(
non_bip_result %in% c("Walk,") ~ 1,
TRUE ~ 0
))
dk <- d %>%
group_by(pitch_group) %>%
summarize(
Outcome = sum(strikeout),
Name = "Strikeout"
)
dbb <- d %>%
group_by(pitch_group) %>%
summarize(
Outcome = sum(walk),
Name = "Walk"
)
ddd <- rbind(dk, dbb)
ggplot(ddd, aes(x = pitch_group, y = Outcome, group = Name, color = Name)) +
geom_point() +
geom_line()
View(d)
#source("Kishor import.R")
library(tidyverse)
d <- read_csv("../data/tonas_clean.csv")
d <- read_csv("../data/tonas_clean.csv")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
# Set up the game variables
score = 0
strikes = 0
balls = 0
outs = 0
inning = 1
max_innings = 9
# Set up the game loop
game_over = FALSE
while (!game_over) {
# Print the current game status
print(paste("Inning:", inning, "Score:", score, "Strikes:", strikes, "Balls:", balls, "Outs:", outs))
# Get the player's action
print("Choose between: swing, bunt, or steal:")
action = readline()
# Process the player's action
if (action == "swing") {
swing_result = sample(c("strike", "hit", "foul"), 1)
if (swing_result == "strike") {
strikes = strikes + 1
if (strikes == 3) {
outs = outs + 1
strikes = 0
balls = 0
}
} else if (swing_result == "hit") {
hit_result = sample(c("single", "double", "triple", "home run"), 1)
if (hit_result == "home run") {
score = score + 4
} else if (hit_result == "triple") {
score = score + 3
} else if (hit_result == "double") {
score = score + 2
} else if (hit_result == "single") {
score = score + 1
}
}
} else if (action == "bunt") {
bunt_result = sample(c("success", "failure"), 1)
if (bunt_result == "success") {
hit_result = sample(c("single", "double", "triple"), 1)
if (hit_result == "triple") {
score = score + 3
} else if (hit_result == "double") {
score = score + 2
} else if (hit_result == "single") {
score = score + 1
}
}
} else if (action == "steal") {
steal_result = sample(c("success", "failure"), 1)
if (steal_result == "success") {
score = score + 1
}
} else {
print("That is not a valid action. Please choose between swing, bunt, or steal.")
}
# Check if the game is over
if (inning > max_innings) {
game_over = TRUE
}
if (outs == 3) {
#setwd("C:/Users/rajmo/Documents/Baseball/Time-Series-Performance/scripts")
source("import_synergy_data.R")
#setwd("C:/Users/rajmo/Documents/Baseball/Time-Series-Performance/scripts")
source("import_synergy_data.R")
#setwd("C:/Users/rajmo/Documents/Baseball/Time-Series-Performance/scripts")
source("import_synergy_data.R")
setwd("C:/Users/rajmo/Documents/Baseball/Time-Series-Performance/scripts")
source("import_synergy_data.R")
d <- read.csv(d)
View(d)
d <- replace(d,d == "", NA)
is.wholenumber <-
function(x, tol = .Machine$double.eps^0.5)  abs(x - round(x)) < tol
d <- d %>%
group_by(outing_id) %>%
mutate(
pitch_num_by_outing = row_number()) %>%
ungroup() %>%
mutate(
pitch_group_by_ten = if_else(is.wholenumber(pitch_num_by_outing/10),(pitch_num_by_outing %/% 10),(pitch_num_by_outing %/% 10) + 1),
pg_b = pitch_group_by_ten * 10,
pg_a = pg_b - 9,
pitch_group = str_c(pg_a, pg_b, sep = "-")
)
avg_pitches_per_outing <- mean(outing_pitch_counts$num_pitches)
pitcher <- unique(d$pitcher)
outing_pitch_counts <- d %>%
group_by(outing_id) %>%
summarise(num_pitches = n())
outing_pitch_counts <- outing_pitch_counts %>%
mutate(outing_id_graph = rev(outing_id))
graph1 <- ggplot(outing_pitch_counts, aes(x = outing_id_graph, y = num_pitches)) +
geom_point() +
geom_line() +
labs(
title = paste(pitcher, "Number of Pitches in Each Outing"),
y = "Number of Pitches Thrown",
x = "Outing Number",
) +
theme_bw()
d_strikepct <- d %>%
mutate(
strike = case_when(
pitch_result %in% c("Strike Swinging", "Strike Taken", "Foul", "BIP") ~ 1,
TRUE ~ 0
)) 	 %>%
group_by(pitch_group) %>%
summarize(
strike_pct = mean(strike),
count = n(),
)
pitcher <- unique(d$pitcher)
outing_pitch_counts <- d %>%
group_by(outing_id) %>%
summarise(num_pitches = n())
avg_pitches_per_outing <- mean(outing_pitch_counts$num_pitches)
rounded_avg_pitches_per_outing <- round(mean(outing_pitch_counts$num_pitches), digits = 0)
std_pitches_per_outing <- sd(outing_pitch_counts$num_pitches)
upper_bound <- (avg_pitches_per_outing/10+1) + (std_pitches_per_outing/10)
lower_bound <- (avg_pitches_per_outing/10+1) - (std_pitches_per_outing/10)
filter(d, pitch_num_by_outing >=112)
outing_pitch_counts <- d %>%
group_by(outing_id) %>%
summarise(num_pitches = n())
outing_pitch_counts <- outing_pitch_counts %>%
mutate(outing_id_graph = rev(outing_id))
View(outing_pitch_counts)
#setwd("C:/Users/rajmo/Documents/Baseball/Time-Series-Performance/scripts")
source("import_synergy_data.R")
#setwd("C:/Users/rajmo/Documents/Baseball/Time-Series-Performance/scripts")
source("import_synergy_data.R")
d <- read.csv(d)
setwd("C:/Users/rajmo/Documents/Baseball/Time-Series-Performance/scripts")
#setwd("C:/Users/rajmo/Documents/Baseball/Time-Series-Performance/scripts")
source("import_synergy_data.R")
#setwd("C:/Users/rajmo/Documents/Baseball/Time-Series-Performance/scripts")
source("import_synergy_data.R")
source("sabermetric_analysis.R")
d <- read.csv(d)
d <- group_pitch_counts(d)
graph1 <- pitches_per_outing(d)
graph5 <- strikepct_pitchcount(d)
graph2 <- kandbbrate_pitchcount(d)
graph3 <- avg_and_obp_pitchcount(d)
graph4 <- slg_and_ops_pitchcount(d)
plot_list <- list(graph1, graph2, graph3, graph4, graph5)
file <- tempfile()
saveRDS(plot_list, file)
rmarkdown::render('rmarkdownfile.Rmd', params = list(file = file))
d_strikepct <- d %>%
mutate(
strike = case_when(
pitch_result %in% c("Strike Swinging", "Strike Taken", "Foul", "BIP") ~ 1,
TRUE ~ 0
)) 	 %>%
group_by(pitch_group) %>%
summarize(
strike_pct = mean(strike),
count = n(),
)
pitcher <- unique(d$pitcher)
outing_pitch_counts <- d %>%
group_by(outing_id) %>%
summarise(num_pitches = n())
avg_pitches_per_outing <- mean(outing_pitch_counts$num_pitches)
rounded_avg_pitches_per_outing <- round(mean(outing_pitch_counts$num_pitches), digits = 0)
std_pitches_per_outing <- sd(outing_pitch_counts$num_pitches)
upper_bound <- (avg_pitches_per_outing/10+1) + (std_pitches_per_outing/10)
lower_bound <- (avg_pitches_per_outing/10+1) - (std_pitches_per_outing/10)
num_outings <- nrow(outing_pitch_counts)
graph1 <- ggplot(d_strikepct) +
geom_point(aes(x = pitch_group, y = strike_pct)) +
geom_line(aes(x = pitch_group, y = strike_pct, group = 1)) +
geom_vline(aes(x = pitch_group, y = strike_pct), xintercept = upper_bound, linetype = "dotted", lwd = 1) +
scale_y_continuous(labels = scales::percent) +
scale_x_discrete(limits = unique(d$pitch_group)) +
labs(
title = paste(pitcher, "Strike % by Pitch Count"),
y = "Strike Percentage",
x = "Pitch Number",
caption = paste("In this data set,",pitcher, "averaged", rounded_avg_pitches_per_outing, "pitches per outing over", num_outings, "outings.")
) +
theme_bw() +
theme(
plot.caption = element_text(size = 9)
)
graph1
graph1 <- ggplot(d_strikepct) +
geom_point(aes(x = pitch_group, y = strike_pct)) +
geom_line(aes(x = pitch_group, y = strike_pct, group = 1)) +
geom_vline(aes(x = pitch_group, y = strike_pct), xintercept = avg_pitches_per_outing, linetype = "dotted", lwd = 1) +
scale_y_continuous(labels = scales::percent) +
scale_x_discrete(limits = unique(d$pitch_group)) +
labs(
title = paste(pitcher, "Strike % by Pitch Count"),
y = "Strike Percentage",
x = "Pitch Number",
caption = paste("In this data set,",pitcher, "averaged", rounded_avg_pitches_per_outing, "pitches per outing over", num_outings, "outings.")
) +
theme_bw() +
theme(
plot.caption = element_text(size = 9)
)
graph1
d <- read.csv(d)
#setwd("C:/Users/rajmo/Documents/Baseball/Time-Series-Performance/scripts")
source("import_synergy_data.R")
source("sabermetric_analysis.R")
d <- read.csv(d)
d <- group_pitch_counts(d)
graph1 <- pitches_per_outing(d)
graph5 <- strikepct_pitchcount(d)
graph2 <- kandbbrate_pitchcount(d)
graph3 <- avg_and_obp_pitchcount(d)
graph4 <- slg_and_ops_pitchcount(d)
plot_list <- list(graph1, graph2, graph3, graph4, graph5)
file <- tempfile()
saveRDS(plot_list, file)
rmarkdown::render('rmarkdownfile.Rmd', params = list(file = file))
plot_list <- list(graph1, graph2, graph3, graph4, graph5)
file <- tempfile()
saveRDS(plot_list, file)
rmarkdown::render('rmarkdownfile.Rmd', params = list(file = file))
plot_list <- list(graph1, graph2, graph3, graph4, graph5)
file <- tempfile()
saveRDS(plot_list, file)
rmarkdown::render('rmarkdownfile.Rmd', params = list(file = file))
plot_list <- list(graph1, graph2, graph3, graph4, graph5)
file <- tempfile()
saveRDS(plot_list, file)
rmarkdown::render('rmarkdownfile.Rmd', params = list(file = file))
graph1 <- ggplot(d_strikepct) +
geom_point(aes(x = pitch_group, y = strike_pct)) +
geom_line(aes(x = pitch_group, y = strike_pct, group = 1)) +
geom_vline(aes(x = pitch_group, y = strike_pct), xintercept = avg_pitches_per_outing/10+1, linetype = "dotted", lwd = 1) +
scale_y_continuous(labels = scales::percent) +
scale_x_discrete(limits = unique(d$pitch_group)) +
labs(
title = paste(pitcher, "Strike % by Pitch Count"),
y = "Strike Percentage",
x = "Pitch Number",
caption = paste("In this data set,",pitcher, "averaged", rounded_avg_pitches_per_outing, "pitches per outing over", num_outings, "outings.")
) +
theme_bw() +
theme(
plot.caption = element_text(size = 9)
)
graph1
d <- read.csv(d)
#setwd("C:/Users/rajmo/Documents/Baseball/Time-Series-Performance/scripts")
source("import_synergy_data.R")
source("sabermetric_analysis.R")
d <- read.csv(d)
d <- group_pitch_counts(d)
graph1 <- pitches_per_outing(d)
graph5 <- strikepct_pitchcount(d)
graph2 <- kandbbrate_pitchcount(d)
graph3 <- avg_and_obp_pitchcount(d)
graph4 <- slg_and_ops_pitchcount(d)
plot_list <- list(graph1, graph2, graph3, graph4, graph5)
file <- tempfile()
saveRDS(plot_list, file)
rmarkdown::render('rmarkdownfile.Rmd', params = list(file = file))
